<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Fisher test simulation}
-->

`https://github.com/clMathLibraries/clRNG`


## Fisher test simulation
```{r packages, results='hide'}
library('gpuR')
library("clrng")
```

```{r memoryAvailable, echo=TRUE, results='hide'}
gpuInfo()$deviceName   #gpuInfo()$maxAllocatableMem/(1024^3)
```


#Example 1
```{r job, eval=TRUE}
Job <- matrix(c(1,2,1,0, 3,3,6,1, 10,10,14,9, 6,7,12,11), 4, 4)
fisher.test(Job, simulate.p.value = TRUE, B = 1e5) # also close to 0.78


streams <-  gpuR::vclMatrix(clrng::createStreamsCpu(n=64*8))
Job<-vclMatrix(Job, type="integer")
result3<-clrng::fisher.sim(Job, 1e5, returnStatistics=T, type="double", streams=streams, Nglobal = c(64,8))


result3$counts
result3$simNum
result3$p.value
result3$streams
as.vector(result3$sim)[10:20]
length(result3$sim)
```
#Example 2
```{r  teaTasting, eval=F}
TeaTasting <-matrix(c(3, 1, 1, 3),nrow=2)
TeaTasting

## Using the R function 
fisher.test(TeaTasting, alternative = "t",  simulate.p.value = TRUE, B = 1e5)


## Using GPU
TeaTasting<-vclMatrix(TeaTasting,type="integer")
result<-clrng::fisher.sim(TeaTasting, 100000L, returnStatistics=F, type="double", Nglobal=c(16,64))

result$p.value
result
```













